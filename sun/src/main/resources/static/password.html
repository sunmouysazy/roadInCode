<!DOCTYPE html>
<html>

<head>

  <meta charset="utf-8"/>
  <title>修改密码页面</title>
  <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
</head>

<body>
<!--顶部-->

<div class="col-md-2">


</div>
<div class="col-md-10	">
  <div class="panel panel-default">
    <ul class="nav nav-tabs">
      <li><a href="userdata.html">个人资料</a></li>
      <li><a href="address.html">登录页面</a></li>
      <li><a href="upload.html">返回主页</a></li>

    </ul>
    <div class="panel-body">
      <form id="password-form" action="updatePassword.html" class="form-horizontal" role="form">
        <div class="form-group">
          <label for="username" class="col-md-2 control-label">原密码：</label>
          <div class="col-md-8">
            <input name="old_password" type="password" class="form-control" id="username" placeholder="请输入原密码">
          </div>
        </div>
        <div class="form-group">
          <span>新密码：</span>
          <div class="col-md-8">
            <input name="new_password" type="password" class="form-control" id="pwd1" placeholder="请输入新密码">
          </div>
        </div>
        <div class="form-group">
          <span>确认密码：</span>
          <div class="col-md-8">
            <input type="password" class="form-control" id="pwd2" placeholder="请再次输入新密码">
          </div>
        </div>
        <div class="form-group">
          <div class="col-sm-offset-2 col-sm-10">
            <input id="btn-password" type="button"
                   class="btn btn-primary" value="修改"/>
          </div>
        </div>
      </form>
    </div>
  </div>

</div>

<!-- 点击修改按钮-->
<script type="text/javascript">
  $('#btn-password').click(function() {
      var pwd1 = document.getElementById('pwd1').value;
      var pwd2 = document.getElementById('pwd2').value;
      <!-- 对比两次输入的密码 -->
      if (pwd1 != pwd2) {
        alert('重新设置的两次密码必须一致！');
        return;
      }
    var url = '../user/update/password';
    var data = $('#password-form').serialize();
    console.log('提交的数据：' + data);
    $.ajax({
      'url': url,
      'data': data,
      'type': 'POST',
      'dataType': 'json',
      'success': function(json) {
        if (json.state == 200) {
          // 修改密码成功
          alert('修改密码成功！');
          window.location.href="login.html";
        } else {
          alert('修改密码失败！' + json.msg);
        }
      },
      'error': function(xhr) {
        // 触发执行error的条件：3xx, 4xx, 5xx
        // 3xx：重定向
        // 4xx：提交的请求有误
        // 5xx：服务器端程序运行错误
        console.log('响应码：' + xhr.state);
        alert('您的登录信息已过期，请重新登录！');
        location.href = 'login.html';
      },
    });
  });
</script>
</body>

</html>